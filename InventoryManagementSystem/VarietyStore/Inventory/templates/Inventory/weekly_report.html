{% extends "Inventory/base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Weekly Reports</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Total Earnings</th>
                <th>Total Losses</th>
                <th>Total Profit/Loss</th>
                <th>Generated By</th>
                <th>Created At</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for report in reports %}
            <tr>
                <td>{{ report.start_date }}</td>
                <td>{{ report.end_date }}</td>
                <td>₱{{ report.total_earnings }}</td>
                <td>₱{{ report.total_losses }}</td>
                <td class="{% if report.total_profit_or_loss >= 0 %}text-success{% else %}text-danger{% endif %}">
                    ₱{{ report.total_profit_or_loss }}
                </td>
                <td>{{ report.generated_by.user.username|default:"System" }}</td>
                <td>{{ report.created_at }}</td>
                <td>
                    <button class="btn btn-info btn-sm" type="button" data-bs-toggle="collapse" 
                            data-bs-target="#details{{ forloop.counter }}" aria-expanded="false">
                        View Details
                    </button>
                </td>
            </tr>
            <tr>
                <td colspan="8" class="p-0">
                    <div class="collapse" id="details{{ forloop.counter }}">
                        <div class="card card-body m-2">
                            <h6>Transaction Summary:</h6>
                            {% if report.notes %}
                                <pre class="mb-0">{{ report.notes }}</pre>
                            {% else %}
                                <p class="mb-0">No detailed information available.</p>
                            {% endif %}
                        </div>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<style>
    pre {
        white-space: pre-wrap;
        font-family: inherit;
        margin: 0;
    }
    .table td {
        vertical-align: middle;
    }
</style>
{% endblock %} 